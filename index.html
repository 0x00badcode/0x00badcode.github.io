<!DOCTYPE html>
<html>
<head>
    <title>App Finder</title>
</head>
<body>
    <h1>Search for an App</h1>
    <input type="text" id="searchInput" placeholder="Enter app name...">
    <button onclick="generateLink()">Generate Link</button>
    <p>Click the link below to view the app details:</p>
    <p><a id="apiLink" href="#" target="_blank">Open App Details</a></p>
    <p>Copy the entire content of the page that opens and paste it into the field below:</p>
    <textarea id="pageContent" rows="10" cols="50" placeholder="Paste the page content here..."></textarea>
    <button onclick="extractAppId()">Extract App ID</button>
    <p id="appIdDisplay">App ID will be displayed here.</p>
    <button id="bannerButton" style="display:none;" onclick="redirectToBanner()">Go to Banner Page</button>

    <script>
    function generateLink() {
        var searchTerm = document.getElementById('searchInput').value;
        var encodedSearchTerm = encodeURIComponent(searchTerm.trim());
        var targetUrl = `https://tools.applemediaservices.com/api/apple-media/apps/US/search.json?types=apps,app-bundles&term=${encodedSearchTerm}&limit=25&l=en-US&platform=iphone&additionalPlatforms=iphone,mac,appletv,ipad,watch,web`;

        var apiLink = document.getElementById('apiLink');
        apiLink.href = targetUrl;
    }

    function extractAppId() {
        var pageContent = document.getElementById('pageContent').value;
        var appIdMatch = pageContent.match(/"id":"(\d+)"/);
        if (appIdMatch && appIdMatch[1]) {
            var appId = appIdMatch[1];
            document.getElementById('appIdDisplay').textContent = `App ID: ${appId}`;

            localStorage.setItem('appId', appId);

            document.getElementById('bannerButton').style.display = 'block';
        } else {
            document.getElementById('appIdDisplay').textContent = 'App ID not found. Please ensure you copied the entire page content.';
        }
    }

    function redirectToBanner() {
        var appId = localStorage.getItem('appId');
        if (appId) {
            var bannerUrl = `banner.html?appId=${appId}`;
            window.location.href = bannerUrl;
        } else {
            alert('No App ID found. Please extract the App ID first.');
        }
    }
    </script>
</body>
</html>
